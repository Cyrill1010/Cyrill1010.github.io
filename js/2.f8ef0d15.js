(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"44c8":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",[s("div",{staticClass:"column q-pa-lg q-gutter-md"},[t.currentStudyset?s("div",{staticClass:"text-h5"},[t._v("\n\t\t\t"+t._s(t.currentStudyset.topic)+"\n\t\t")]):t._e(),t.currentStudyset&&t.currentStudyset.items?s("q-list",{staticClass:"rounded-borders",attrs:{bordered:""}},[s("q-item-label",{staticClass:"text-weight-medium",attrs:{header:""}},[t._v("Stats")]),s("q-item",[s("q-item-section",{attrs:{top:""}},[s("div",{staticClass:"row full-width"},[s("div",{staticClass:"col"},[s("q-item-label",{attrs:{caption:""}},[t._v("\n\t\t\t\t\t\t\t\tNumber of terms:\n\t\t\t\t\t\t\t\t"+t._s(t.currentStudyset.items.length)+"\n\t\t\t\t\t\t\t")]),s("q-item-label",{attrs:{caption:""}},[t._v("\n\t\t\t\t\t\t\t\tSuccesses:\n\t\t\t\t\t\t\t\t"+t._s(t.currentLearnCycleSuccessCount)+"\n\t\t\t\t\t\t\t")])],1),s("q-item-label",{attrs:{caption:""}},[t._v("\n\t\t\t\t\t\t\tFails: "+t._s(t.currentLearnCycleFailsCount)+"\n\t\t\t\t\t\t")])],1)]),s("q-item-section",[s("timeline",{attrs:{dates:t.repetitionDates}})],1)],1),t.currentTerm?s("q-item",[s("q-item-section",{attrs:{top:""}},[s("div",{staticClass:"row full-width"},[s("div",{staticClass:"col"},[s("q-item-label",{attrs:{caption:""}},[t._v("\n\t\t\t\t\t\t\t\tTerm: "+t._s(t.currentTermIndex)+" of\n\t\t\t\t\t\t\t\t"+t._s(t.currentStudyset.items.length)+" ")]),s("q-item-label",{attrs:{caption:""}},[t._v("\n\t\t\t\t\t\t\t\tLast attempt: "+t._s(t.lastAttempt)+"\n\t\t\t\t\t\t\t")])],1),s("div",{staticClass:"col"},[s("q-item-label",{staticClass:"row items-center",attrs:{caption:""}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.numberOfSuccesses)+" Successes\n\t\t\t\t\t\t\t\t"),s("div",{style:{width:10*t.numberOfSuccesses+"px",backgroundColor:"green",height:"10px",marginLeft:"5px",borderRadius:"2px"}})]),s("q-item-label",{attrs:{caption:""}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.numberOfFails)+" Fails\n\t\t\t\t\t\t\t\t"),s("div",{style:{width:10*t.numberOfFails+"px",backgroundColor:"red",height:"10px",marginLeft:"5px",borderRadius:"2px"}})])],1),s("div",{staticClass:"col"},[s("q-item-label",{attrs:{caption:""}},[t._v("\n\t\t\t\t\t\t\t\tLearnmethod:\n\t\t\t\t\t\t\t\t"+t._s(t.currentStudyset.learnMethod)+" ")]),s("q-item-label",{attrs:{caption:""}},[t._v("\n\t\t\t\t\t\t\t\tRequired successes:\n\t\t\t\t\t\t\t\t"+t._s(t.currentStudyset.requiredSuccesses)+"\n\t\t\t\t\t\t\t")])],1)])])],1):t._e()],1):t._e(),!t.completedStudySession&&t.currentTerm&&"Cards"===t.learnType?s("div",{staticClass:"flip-card",on:{click:function(e){t.showSolution=!t.showSolution}}},[s("div",{staticClass:"flip-card-inner",class:{"flip-card-rotated":t.showSolution}},[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.showSolution,expression:"!showSolution"}],staticClass:"flip-card-front"},[s("q-card",{staticClass:"column full-width full-height"},[s("q-card-section",{staticClass:"col text-subtitle1"},[t._v("Definition")]),s("q-card-section",{staticClass:"col text-body1 text-weight-bold"},[t._v(t._s(t.currentTerm.key))])],1)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.showSolution,expression:"showSolution"}],staticClass:"flip-card-back"},[s("q-card",{staticClass:"column full-height full-width",style:{backgroundColor:t.backgroundColor,color:t.backgroundColor?"white":"black"}},[s("q-card-section",{staticClass:"col text-subtitle1"},[t._v("Solution")]),s("q-card-section",{staticClass:"col text-body1 text-weight-bold"},[t._v(t._s(t.currentTerm.val))])],1)],1)])]):!t.completedStudySession&&t.currentTerm&&"Writing"===t.learnType?s("q-card",[s("q-card-section",{staticClass:"col-8"},[s("q-input",{attrs:{standout:"bg-grey-4",dense:"",autofocus:""},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}}),s("q-btn",{attrs:{label:"verify"},on:{click:t.verify}})],1)],1):t._e(),t.completedStudySession?s("q-banner",{staticClass:"bg-purple-8 text-white",attrs:{rounded:""},scopedSlots:t._u([{key:"action",fn:function(){return[s("q-btn",{attrs:{flat:"",color:"white",label:"Continue as a Guest"}}),s("q-btn",{attrs:{flat:"",color:"white",label:"Sign in"}})]},proxy:!0}],null,!1,3345952433)},[t._v("\n\t\t\tWe can't find your saved recipes until you sign in.\n\n\t\t\t")]):t._e(),s("div",{staticClass:"row",staticStyle:{position:"fixed",bottom:"46px",right:"16px",height:"10px"},attrs:{id:"buttonRow"}},[s("q-btn",{staticClass:"col-2",attrs:{label:"reveal"},on:{click:function(e){t.showSolution=!t.showSolution}}}),s("q-btn",{staticClass:"col bg-negative q-mx-lg",attrs:{label:"Didn't know"},on:{click:t.onFail}}),s("q-btn",{staticClass:"col bg-positive",attrs:{label:"I know"},on:{click:t.onSuccess}})],1),s("pre",[s("code",[t._v(t._s(JSON.stringify(t.currentStudyset,null,2)))])])],1)])},i=[],n=s("f65c"),c=(s("ddb0"),s("5fb0")),a=s("025e");class l{constructor(){}computeTerms(t){const e=t.requiredSuccesses?t.requiredSuccesses:6;if(c["a"].STUDYSET_STATES_IN_PROGRESS.includes(t.status)){let s=t.items.filter((t=>!t.history||t.history.filter((t=>t.success)).length<=e));s.forEach((t=>t.successCurrentRun=null));let r=Object(a["g"])(s),i={...t,items:r};return i}return[]}}var o=l;class u{constructor(){}provideStudysetTerms(t){const e=new o;let s=[];for(let r of t)switch(r.learnMethod){case"simpleRepetition":s.push(e.computeTerms(r));break;case"spacedRepetition":s.push(n["a"].computeTerms(r));break;default:s.push(e.computeTerms(r))}return console.log("provide studysetTerms",s),s}}var d=u,h=s("d3f2"),m=s("52cd"),p=s.n(m),S=s("2f62");const y=new d;var f={name:"Learning",components:{Timeline:h["a"]},mounted(){this.loadData()},data(){return{studysetsWithFilteredTerms:[],currentStudysetIndex:0,currentTermIndex:0,input:"",completedStudySession:!1,showSolution:!1,currentLearnCycleSuccessCount:0,currentLearnCycleFailsCount:0}},computed:{...Object(S["b"])("database",{folders:t=>t.folders}),currentStudyset(){return this.studysetsWithFilteredTerms?(console.log("compute currentStudyset"),this.studysetsWithFilteredTerms[this.currentStudysetIndex]):null},currentTerm(){return this.studysetsWithFilteredTerms&&this.currentStudyset&&this.currentStudyset.items?this.currentStudyset.items[this.currentTermIndex]:null},numberOfSuccesses(){return this.currentTerm.history?this.currentTerm.history.filter((t=>t.success)).length:0},lastAttempt(){const t=this.currentTerm.history,e=t&&t.length>0?t[t.length-1].date:null;return e?new Date(Date.parse(e)).toLocaleString():""},numberOfFails(){return this.currentTerm.history.filter((t=>!1===t.success)).length},learnType(){this.currentStudyset.initialLearningPhase;return this.currentStudyset.learnType},backgroundColor(){return this.currentTerm.backgroundColor}},methods:{loadData(){console.log("loadData");let t=`$[?(@.folderId=="${this.$route.params.folderId}")].studysets[?(@.topicId=="${this.$route.params.topicId}")]`;console.log(t);let e=p.a.query(this.folders,t);console.log("studyset=",e),console.log("Params",this.$route.params),this.studysetsWithFilteredTerms=this.getStudysetsWithFilteredTerms(e),console.log("studysetsWithFilteredTerms",this.studysetsWithFilteredTerms),this.loadRepetitionDates()},loadRepetitionDates(){let t=this.currentStudyset,e=new Date(Date.parse(t.dueDate)),s=new Date(Date.parse(t.startDate));this.repetitionDates=n["a"].calculateRepetitionDates(e,s,t.numberOfRepetitions)},getStudysetsWithFilteredTerms(t){let e=y.provideStudysetTerms(t);return console.log("compute studysetsWithFilteredTerms",e),e},onSuccess(){Object(a["a"])({term:this.currentTerm,success:!0}),this.next()},onFail(){Object(a["a"])({term:this.currentTerm,success:!1}),this.next()},next(){this.currentLearnCycleSuccessCount=Object(a["b"])({studyset:this.currentStudyset,expectedSuccessValue:!0}),this.currentLearnCycleFailsCount=Object(a["b"])({studyset:this.currentStudyset,expectedSuccessValue:!1}),this.currentTermIndex<this.currentStudyset.items.length-1?(this.currentTermIndex++,console.log("next")):(this.currentTermIndex=null,this.completedStudySession=!0,this.studysetCompleted())},studysetCompleted(){this.$q.notify({message:"You've completed all studysets!\n Congratulations"}),this.completedStudySession=!0,this.currentTermIndex=null},capitalizeFirstLetter(t){return t.charAt(0).toUpperCase()+t.substring(1)},trackHistory(t){this.currentTerm.history||(this.currentTerm.history=[]),this.currentTerm.history.push({date:new Date(Date.now()),success:t})},verify(){this.input===this.currentTerm.val?(this.$q.notify({message:"Yeah correct",color:"purple"}),this.input="",this.trackHistory(!0)):(this.$q.notify({message:`Wrong. \n Right Solution: ${this.currentTerm.val}`,color:"purple"}),this.trackHistory(!1),this.input=""),this.currentTermIndex<this.currentStudyset.items.length-1?this.currentTermIndex++:this.currentStudysetIndex<this.studysetsWithFilteredTerms.length-1?(this.currentTermIndex=0,this.currentStudysetIndex++):this.studysetCompleted()}},watch:{$route(t,e){this.loadData()}}},b=f,T=(s("b819"),s("2877")),g=s("9989"),v=s("1c1c"),_=s("0170"),x=s("66e5"),C=s("4074"),w=s("f09f"),q=s("a370"),D=s("27f9"),k=s("9c40"),I=s("54e1"),O=s("eebe"),R=s.n(O),F=Object(T["a"])(b,r,i,!1,null,"3da8fa20",null);e["default"]=F.exports;R()(F,"components",{QPage:g["a"],QList:v["a"],QItemLabel:_["a"],QItem:x["a"],QItemSection:C["a"],QCard:w["a"],QCardSection:q["a"],QInput:D["a"],QBtn:k["a"],QBanner:I["a"]})},5644:function(t,e,s){},"5fb0":function(t,e,s){"use strict";e["a"]={STUDYSET_STATES:["running","notStarted","completed","cancelled"],STUDYSET_STATES_IN_PROGRESS:["running"]}},"89b2":function(t,e,s){"use strict";s("d2ea")},b819:function(t,e,s){"use strict";s("5644")},d2ea:function(t,e,s){},d3f2:function(t,e,s){"use strict";var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{padding:"0 20px"}},[s("div",{staticStyle:{position:"relative",height:"80px"}},[t._l(t.dates,(function(e,r){return[s("div",{key:r,staticClass:"circle",style:t.circleStyle(e,r),on:{click:function(s){return t.$emit("onDateSelected",e)}}}),r<t.dates.length-1?s("div",{key:r+"_",staticClass:"line",style:t.intervalStyle(e,r)}):t._e(),s("div",{key:r+"__",staticClass:"text",style:t.textStyle(e,r),on:{click:function(s){return t.$emit("onDateSelected",e)}}},[s("div",[t._v(t._s(t.formatDate(e)))]),t.showTime?s("div",[t._v(t._s(t.formatTime(e)))]):t._e()])]}))],2)])},i=[],n=s("025e");function c(t,e,s){return Object(n["e"])(t,e)/s*100+"%"}var a={name:"Timeline",props:{dates:{type:Array},showTime:Boolean},methods:{formatDate(t){return Object(n["d"])(t)},formatTime(t){return Object(n["c"])(t)},intervalStyle(t,e){return{left:`calc(${c(this.dates[0],t,this.totalHours)} + 15px)`,width:`calc(${c(t,this.dates[e+1],this.totalHours)} - 30px)`}},circleStyle(t,e){return{left:`calc(${c(this.dates[0],t,this.totalHours)} - 10px)`,width:"20px"}},textStyle(t,e){let s=c(this.dates[0],t,this.totalHours);return{left:`calc(${s} - 50px)`,top:e%2===0?this.showTime?"0px":"15px":"52px"}}},computed:{totalHours(){return this.dates.length>0?Object(n["e"])(this.dates[0],this.dates[this.dates.length-1]):0}}},l=a,o=(s("89b2"),s("2877")),u=Object(o["a"])(l,r,i,!1,null,"e5638c4c",null);e["a"]=u.exports},f65c:function(t,e,s){"use strict";var r=s("5fb0"),i=s("025e");const n=864e5;class c{constructor(){}computeTerms(t,e){console.log(`includes ${r["a"].STUDYSET_STATES_IN_PROGRESS.includes(t.status)}`);const s=t.requiredSuccesses?t.requiredSuccesses:6;if(r["a"].STUDYSET_STATES_IN_PROGRESS.includes(t.status)){let e=t.items.filter((t=>!t.history||t.history.filter((t=>t.success)).length<=s));e.forEach((t=>t.successCurrentRun=null));let r=Object(i["g"])(e),n={...t,items:r};return console.log("simpleRepetionStudysetTerms",JSON.stringify(n,null,2)),n}return[]}calculateNextRepetitionDateTime({repetitionNumber:t,totalDays:e,retentionDecreases:s=[1.7,3.1,6.7,10,20,30,40,50]}){const r=s,i=.8;let n=0;for(let a=0;a<t;a++)n+=r[a];const c=-Math.log(i)*n;return e?c/9.2*e:c}calculateRepetitionDates(t,e,s){console.log("calculateRepetitionDates");let r=[],i=(t.getTime()-e.getTime())/n;for(let c=0;c<s;c++){let t=c+1,s=this.calculateNextRepetitionDateTime({repetitionNumber:t,totalDays:i}),a=new Date(e.getTime()+n*s);r.push(a)}return r}}const a=new c;e["a"]=a}}]);